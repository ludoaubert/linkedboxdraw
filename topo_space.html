<html>
<head>
<link rel="stylesheet" href="topo_space.css">
<script type="module" src="topo_space.js"></script>
</head>
<body onload="main()">

<div class="grid-container">

<div id="main_svg">

</div>

<div id="dt_div">
<table id="decision_tree">
  <thead>
    <tr>
      <th>i</th>
      <th>parent_index</th>
      <th>depth</th>
      <th>i_emplacement_source</th>
      <th>i_emplacement_destination</th>
      <th>match</td>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>69</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>69</td>
    </tr>
  </tbody>
</table>

<table id="chemin">
  <thead>
    <tr>
      <th>i</th>
      <th>parent_index</th>
      <th>depth</th>
      <th>i_emplacement_source</th>
      <th>i_emplacement_destination</th>
      <th>match</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>69</td>
    </tr>
    <tr>
      <td>0</td>
      <td>-1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>69</td>
    </tr>
  </tbody>
</table>
</div>

</div>

  <script>
var selected = null;

let dt = document.querySelector('#decision_tree');

dt.addEventListener('mouseover', (event)=>{
// 'highlight' color is set in tablelist.css
       let tr = event.target.parentNode;
       if ( tr.className === '') {
            tr.className='highlight';
       }
       return false
});

dt.addEventListener('mouseout', (event)=>{
       let tr = event.target.parentNode;
       if ( tr.className === 'highlight') {
            tr.className='';
       }
       return false
});

dt.addEventListener('mousedown', (event)=>{

       let tr = event.target.parentNode;

     if ( tr.className !== 'clicked' ) {
// Clear previous selection
            if ( selected !== null ) {
                 selected.className='';
            }
// Mark this row as selected
            tr.className='clicked';
            selected = tr;
	   const i = parseInt(tr.cells[0],10);
	let arr = [];
        while (i != -1)
        {
		arr.push(decision_tree[i]);
		i = decision_tree[i].parent_index;
	}
	let cm = document.getElementById("chemin");
	cm.innerHTML = arr.map(({i, parent_index, depth, i_emplacement_source, i_emplacement_destination, match}) => `<tr><td>${i}</td><td>${parent_index}</td><td>${depth}</td><td>${i_emplacement_source}</td><td></tr>`)
			.join('\n');

     }
     else {
           tr.className='';
           selected = null;
     }
     return true
});
  </script>

</body>
</html>
